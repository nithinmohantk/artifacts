<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendor Comparison Matrix</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            color: #718096;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .vendor-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .vendor-input input {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
            width: 150px;
        }
        
        button {
            padding: 8px 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #5a67d8;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        button.secondary {
            background: #48bb78;
        }
        
        button.secondary:hover {
            background: #38a169;
        }
        
        .table-wrapper {
            overflow-x: auto;
            margin-bottom: 30px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        
        th {
            background: #4a5568;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 10px 12px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        tr:hover {
            background: #f7fafc;
        }
        
        .category-header {
            background: #edf2f7 !important;
            font-weight: 700;
            color: #2d3748;
            font-size: 14px;
        }
        
        .requirement-cell {
            font-weight: 500;
            color: #4a5568;
        }
        
        .weight-cell {
            text-align: center;
            color: #718096;
            font-weight: 600;
        }
        
        .vendor-input-cell {
            text-align: center;
        }
        
        input[type="number"] {
            width: 60px;
            padding: 6px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            text-align: center;
            font-size: 13px;
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .score-cell {
            text-align: center;
            font-weight: 700;
            font-size: 14px;
        }
        
        .total-row {
            background: #f7fafc;
            font-weight: 700;
            font-size: 15px;
        }
        
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .summary-card h3 {
            font-size: 16px;
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .summary-card .score {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .summary-card .rating {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .winner {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }
        
        .chart-section {
            margin-top: 30px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
        }
        
        .chart-section h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 20px;
        }
        
        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .bar-label {
            width: 150px;
            font-weight: 600;
            color: #4a5568;
            font-size: 13px;
        }
        
        .bar-container {
            flex: 1;
            height: 30px;
            background: #e2e8f0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: 700;
            font-size: 12px;
            transition: width 1s ease;
        }
        
        @media print {
            body {
                background: white;
            }
            .controls {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè• HL7/FHIR Vendor Evaluation Matrix</h1>
        <p class="subtitle">Compare vendors across functional, technical, security, and commercial dimensions</p>
        
        <div class="controls">
            <div class="vendor-input">
                <label>Vendor 1:</label>
                <input type="text" id="vendor1Name" placeholder="Vendor Name" value="Vendor A">
            </div>
            <div class="vendor-input">
                <label>Vendor 2:</label>
                <input type="text" id="vendor2Name" placeholder="Vendor Name" value="Vendor B">
            </div>
            <div class="vendor-input">
                <label>Vendor 3:</label>
                <input type="text" id="vendor3Name" placeholder="Vendor Name" value="Vendor C">
            </div>
            <button onclick="calculateScores()">üìä Calculate Scores</button>
            <button onclick="exportResults()" class="secondary">üíæ Export Results</button>
        </div>
        
        <div class="table-wrapper">
            <table id="evaluationTable">
                <thead>
                    <tr>
                        <th style="width: 35%;">Requirement</th>
                        <th style="width: 8%;">Weight</th>
                        <th style="width: 8%;">Max</th>
                        <th style="width: 13%;" class="vendor1-header">Vendor 1</th>
                        <th style="width: 9%;">Score</th>
                        <th style="width: 13%;" class="vendor2-header">Vendor 2</th>
                        <th style="width: 9%;">Score</th>
                        <th style="width: 13%;" class="vendor3-header">Vendor 3</th>
                        <th style="width: 9%;">Score</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>
        
        <div class="summary" id="summarySection"></div>
        
        <div class="chart-section">
            <h2>üìà Category Comparison</h2>
            <div class="bar-chart" id="chartSection"></div>
        </div>
    </div>
    
    <script>
        const requirements = [
            {
                category: "FUNCTIONAL REQUIREMENTS (35%)",
                items: [
                    { name: "HL7 v2 Support", weight: 0.06, max: 10 },
                    { name: "FHIR R4 Implementation", weight: 0.06, max: 10 },
                    { name: "Message Transformation", weight: 0.05, max: 10 },
                    { name: "Data Validation & Quality", weight: 0.05, max: 10 },
                    { name: "Error Handling & Recovery", weight: 0.05, max: 10 },
                    { name: "Routing & Orchestration", weight: 0.05, max: 10 },
                    { name: "Pre-built Connectors", weight: 0.03, max: 10 }
                ]
            },
            {
                category: "TECHNICAL CAPABILITIES (30%)",
                items: [
                    { name: "System Architecture", weight: 0.05, max: 5 },
                    { name: "Performance & Throughput", weight: 0.05, max: 5 },
                    { name: "API Management", weight: 0.04, max: 5 },
                    { name: "Integration Patterns", weight: 0.04, max: 5 },
                    { name: "Monitoring & Observability", weight: 0.04, max: 5 },
                    { name: "DevOps & CI/CD", weight: 0.03, max: 5 },
                    { name: "Data Storage Options", weight: 0.03, max: 5 },
                    { name: "Standards Compliance", weight: 0.02, max: 5 }
                ]
            },
            {
                category: "SECURITY & COMPLIANCE (20%)",
                items: [
                    { name: "Authentication & Authorization", weight: 0.03, max: 5 },
                    { name: "Encryption & Data Protection", weight: 0.03, max: 5 },
                    { name: "Audit & Compliance", weight: 0.03, max: 5 },
                    { name: "Regulatory Certifications", weight: 0.03, max: 5 },
                    { name: "Vulnerability Management", weight: 0.02, max: 5 },
                    { name: "Consent Management", weight: 0.02, max: 5 },
                    { name: "Data Privacy Controls", weight: 0.02, max: 5 },
                    { name: "Network Security", weight: 0.02, max: 5 }
                ]
            },
            {
                category: "VENDOR VIABILITY (10%)",
                items: [
                    { name: "Financial Stability", weight: 0.02, max: 3 },
                    { name: "Market Presence", weight: 0.02, max: 3 },
                    { name: "Healthcare Experience", weight: 0.02, max: 3 },
                    { name: "Support & SLA", weight: 0.02, max: 3 },
                    { name: "Training & Documentation", weight: 0.01, max: 3 },
                    { name: "Implementation Services", weight: 0.01, max: 3 }
                ]
            },
            {
                category: "COMMERCIAL TERMS (5%)",
                items: [
                    { name: "Pricing Model", weight: 0.015, max: 4 },
                    { name: "Total Cost of Ownership", weight: 0.015, max: 4 },
                    { name: "Contract Flexibility", weight: 0.01, max: 4 },
                    { name: "Value for Money", weight: 0.01, max: 4 }
                ]
            }
        ];
        
        function initializeTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';
            
            requirements.forEach(category => {
                const categoryRow = document.createElement('tr');
                categoryRow.innerHTML = `
                    <td colspan="9" class="category-header">${category.category}</td>
                `;
                tbody.appendChild(categoryRow);
                
                category.items.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="requirement-cell">${item.name}</td>
                        <td class="weight-cell">${(item.weight * 100).toFixed(1)}%</td>
                        <td class="weight-cell">${item.max}</td>
                        <td class="vendor-input-cell"><input type="number" min="0" max="${item.max}" step="0.5" value="0" class="v1-input"></td>
                        <td class="score-cell v1-score">0.0</td>
                        <td class="vendor-input-cell"><input type="number" min="0" max="${item.max}" step="0.5" value="0" class="v2-input"></td>
                        <td class="score-cell v2-score">0.0</td>
                        <td class="vendor-input-cell"><input type="number" min="0" max="${item.max}" step="0.5" value="0" class="v3-input"></td>
                        <td class="score-cell v3-score">0.0</td>
                    `;
                    tbody.appendChild(row);
                });
            });
            
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td colspan="3">TOTAL WEIGHTED SCORE</td>
                <td colspan="2" class="score-cell" id="v1-total">0.0</td>
                <td colspan="2" class="score-cell" id="v2-total">0.0</td>
                <td colspan="2" class="score-cell" id="v3-total">0.0</td>
            `;
            tbody.appendChild(totalRow);
        }
        
        function calculateScores() {
            const rows = document.querySelectorAll('#tableBody tr:not(.total-row):not(:has(.category-header))');
            let v1Total = 0, v2Total = 0, v3Total = 0;
            let categoryScores = {v1: {}, v2: {}, v3: {}};
            let categoryIndex = 0;
            let itemIndex = 0;
            
            rows.forEach((row, index) => {
                if (itemIndex >= requirements[categoryIndex].items.length) {
                    categoryIndex++;
                    itemIndex = 0;
                }
                
                if (categoryIndex >= requirements.length) return;
                
                const category = requirements[categoryIndex].category;
                const item = requirements[categoryIndex].items[itemIndex];
                
                const v1Input = parseFloat(row.querySelector('.v1-input').value) || 0;
                const v2Input = parseFloat(row.querySelector('.v2-input').value) || 0;
                const v3Input = parseFloat(row.querySelector('.v3-input').value) || 0;
                
                const v1Score = v1Input * item.weight * 100;
                const v2Score = v2Input * item.weight * 100;
                const v3Score = v3Input * item.weight * 100;
                
                row.querySelector('.v1-score').textContent = v1Score.toFixed(1);
                row.querySelector('.v2-score').textContent = v2Score.toFixed(1);
                row.querySelector('.v3-score').textContent = v3Score.toFixed(1);
                
                v1Total += v1Score;
                v2Total += v2Score;
                v3Total += v3Score;
                
                if (!categoryScores.v1[category]) {
                    categoryScores.v1[category] = 0;
                    categoryScores.v2[category] = 0;
                    categoryScores.v3[category] = 0;
                }
                
                categoryScores.v1[category] += v1Score;
                categoryScores.v2[category] += v2Score;
                categoryScores.v3[category] += v3Score;
                
                itemIndex++;
            });
            
            document.getElementById('v1-total').textContent = v1Total.toFixed(1);
            document.getElementById('v2-total').textContent = v2Total.toFixed(1);
            document.getElementById('v3-total').textContent = v3Total.toFixed(1);
            
            updateSummary(v1Total, v2Total, v3Total);
            updateChart(categoryScores);
        }
        
        function updateSummary(v1Total, v2Total, v3Total) {
            const v1Name = document.getElementById('vendor1Name').value;
            const v2Name = document.getElementById('vendor2Name').value;
            const v3Name = document.getElementById('vendor3Name').value;
            
            const scores = [
                {name: v1Name, score: v1Total},
                {name: v2Name, score: v2Total},
                {name: v3Name, score: v3Total}
            ].sort((a, b) => b.score - a.score);
            
            const summarySection = document.getElementById('summarySection');
            summarySection.innerHTML = scores.map((vendor, index) => `
                <div class="summary-card ${index === 0 ? 'winner' : ''}">
                    <h3>${index === 0 ? 'üèÜ ' : ''}${vendor.name}</h3>
                    <div class="score">${vendor.score.toFixed(1)}</div>
                    <div class="rating">${getRating(vendor.score)}</div>
                </div>
            `).join('');
        }
        
        function getRating(score) {
            if (score >= 90) return 'Excellent - Highly Recommended';
            if (score >= 80) return 'Good - Recommended';
            if (score >= 70) return 'Acceptable - Gaps to Address';
            if (score >= 60) return 'Marginal - High Risk';
            return 'Not Recommended';
        }
        
        function updateChart(categoryScores) {
            const v1Name = document.getElementById('vendor1Name').value;
            const v2Name = document.getElementById('vendor2Name').value;
            const v3Name = document.getElementById('vendor3Name').value;
            
            const chartSection = document.getElementById('chartSection');
            chartSection.innerHTML = '';
            
            Object.keys(categoryScores.v1).forEach(category => {
                const maxScore = Math.max(
                    categoryScores.v1[category],
                    categoryScores.v2[category],
                    categoryScores.v3[category]
                );
                
                const categoryDiv = document.createElement('div');
                categoryDiv.innerHTML = `<strong style="color: #2d3748; margin-bottom: 10px; display: block;">${category}</strong>`;
                
                [
                    {name: v1Name, score: categoryScores.v1[category]},
                    {name: v2Name, score: categoryScores.v2[category]},
                    {name: v3Name, score: categoryScores.v3[category]}
                ].forEach(vendor => {
                    const barItem = document.createElement('div');
                    barItem.className = 'bar-item';
                    barItem.innerHTML = `
                        <div class="bar-label">${vendor.name}</div>
                        <div class="bar-container">
                            <div class="bar-fill" style="width: ${maxScore > 0 ? (vendor.score / maxScore * 100) : 0}%">
                                ${vendor.score.toFixed(1)}
                            </div>
                        </div>
                    `;
                    categoryDiv.appendChild(barItem);
                });
                
                chartSection.appendChild(categoryDiv);
            });
        }
        
        function exportResults() {
            const v1Name = document.getElementById('vendor1Name').value;
            const v2Name = document.getElementById('vendor2Name').value;
            const v3Name = document.getElementById('vendor3Name').value;
            
            let csvContent = `Requirement,Weight,Max Score,${v1Name},${v1Name} Score,${v2Name},${v2Name} Score,${v3Name},${v3Name} Score\n`;
            
            const rows = document.querySelectorAll('#tableBody tr:not(.total-row)');
            rows.forEach(row => {
                if (row.querySelector('.category-header')) {
                    csvContent += `\n"${row.textContent}"\n`;
                } else {
                    const cells = row.querySelectorAll('td, input');
                    const rowData = [
                        row.querySelector('.requirement-cell')?.textContent || '',
                        row.querySelector('.weight-cell')?.textContent || '',
                        cells[2]?.textContent || '',
                        row.querySelector('.v1-input')?.value || '',
                        row.querySelector('.v1-score')?.textContent || '',
                        row.querySelector('.v2-input')?.value || '',
                        row.querySelector('.v2-score')?.textContent || '',
                        row.querySelector('.v3-input')?.value || '',
                        row.querySelector('.v3-score')?.textContent || ''
                    ];
                    csvContent += rowData.join(',') + '\n';
                }
            });
            
            csvContent += `\nTOTAL,,,${document.getElementById('v1-total').textContent},,,${document.getElementById('v2-total').textContent},,,${document.getElementById('v3-total').textContent}`;
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'vendor_evaluation_results.csv';
            a.click();
        }
        
        document.getElementById('vendor1Name').addEventListener('change', updateHeaders);
        document.getElementById('vendor2Name').addEventListener('change', updateHeaders);
        document.getElementById('vendor3Name').addEventListener('change', updateHeaders);
        
        function updateHeaders() {
            const v1Name = document.getElementById('vendor1Name').value;
            const v2Name = document.getElementById('vendor2Name').value;
            const v3Name = document.getElementById('vendor3Name').value;
            
            document.querySelector('.vendor1-header').textContent = v1Name;
            document.querySelector('.vendor2-header').textContent = v2Name;
            document.querySelector('.vendor3-header').textContent = v3Name;
        }
        
        initializeTable();
    </script>
</body>
</html>
